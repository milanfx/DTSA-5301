---
output:
  html_document: default
  pdf_document: default
---

<table style="width: 900px"><tr><td bgcolor="darkred"><font color="white" size="10"><div style="text-align: center;"><b>
NYDP Shooting Data Report
</b></div></font></td></tr></table>

----------------------------------------------------------------------------------------------------------------------------------------------------------------------

<table style="width: 900px"><tr><td bgcolor="darkred"><font color="white" size="6"><b>
&nbsp;&nbsp;1. Introduction
</b></font></td></tr></table>

<table style="width: 900px"><tr><td bgcolor="wheat"><font color="brown" size="5"><b>
&nbsp;&nbsp;1.1 Project Objective
</b></font></td></tr></table>

#### 1. Data Cleaning and Preprocessing: Ensure data quality and consistency by performing data cleaning tasks.
#### 2. Timeline Trend Analysis: Explore temporal patterns to identify peaks and valleys during specific time intervals.
#### 3. Geographical Distribution Analysis: Investigate case clusters in certain regions to understand spatial patterns.
#### 4. Suspects & Victims Analysis: Examine profiles of involved individuals to uncover distinct features and trends.
#### 5. Time Series Analysis and Forecasting: Examine seasonal patterns and project case counts for the next 3 years.
 
<table style="width: 900px"><tr><td bgcolor="wheat"><font color="brown" size="5"><b>
&nbsp;&nbsp;1.2 Data Source
</b></font></td></tr></table>

#### 1. This data is sourced from the official NYPD website and includes shooting records spanning from 2006 to 2022.
#### 2. Each record depicts an occurrence of a shooting incident in New York City and encompasses details about the event, including its location, timestamp, and profiles of individuals involved.
#### 3. The compilation of this data involves a manual extraction process conducted quarterly with a comprehensive review by the Office of Management Analysis and Planning. However, some degree of error might be present in the dataset.

<table style="width: 900px"><tr><td bgcolor="wheat"><font color="brown" size="5"><b>
&nbsp;&nbsp;1.3 Importing Packages
</b></font></td></tr></table>

```{r message=FALSE, warning=FALSE}
library(tidyverse)
library(lubridate)
library(cowplot)
library(ggthemes)
library(forecast)
library(knitr)
library(data.table)
library(leaflet)
library(tinytex)
library(kableExtra)
library(gridExtra)
library(dplyr)
```

<table style="width: 900px"><tr><td bgcolor="wheat"><font color="brown" size="5"><b>
&nbsp;&nbsp;1.4 Importing Dataset
</b></font></td></tr></table>

```{r message=FALSE, warning=FALSE}
file_path <- "https://data.cityofnewyork.us/api/views/833y-fsy8/rows.csv"
df1 <- read_csv(file_path)
```

----------------------------------------------------------------------------------------------------------------------------------------------------------------------

<table style="width: 900px"><tr><td bgcolor="darkred"><font color="white" size="6"><b>
&nbsp;&nbsp;2. Data Cleaning and Preprocessing
</b></font></td></tr></table>

<table style="width: 900px"><tr><td bgcolor="wheat"><font color="brown" size="5"><b>
&nbsp;&nbsp;2.1 Checking Data
</b></font></td></tr></table>

```{r}
glimpse(df1)
```

<table style="width: 900px"><tr><td bgcolor="wheat"><font color="brown" size="5"><b>
&nbsp;&nbsp;2.2 Selecting Attributes
</b></font></td></tr></table>

```{r}
df2 <- df1 %>%
  select(
    -c("INCIDENT_KEY", "LOC_OF_OCCUR_DESC", "JURISDICTION_CODE", "LOC_CLASSFCTN_DESC", "LOCATION_DESC", 
       "X_COORD_CD", "Y_COORD_CD", "Lon_Lat")
    )
glimpse(df2)
```

<table style="width: 900px"><tr><td bgcolor="wheat"><font color="brown" size="5"><b>
&nbsp;&nbsp;2.3 Modifying Attribute Names
</b></font></td></tr></table>

```{r}
df3 <- df2 %>%
  rename(
    Date = OCCUR_DATE,
    Time = OCCUR_TIME,
    Borough = BORO,
    Precinct = PRECINCT,
    Murder = STATISTICAL_MURDER_FLAG,
    Perp_Age = PERP_AGE_GROUP,
    Perp_Sex = PERP_SEX,
    Perp_Race = PERP_RACE,
    Vic_Age = VIC_AGE_GROUP,
    Vic_Sex = VIC_SEX,
    Vic_Race = VIC_RACE
  )
glimpse(df3)
```

<table style="width: 900px"><tr><td bgcolor="wheat"><font color="brown" size="5"><b>
&nbsp;&nbsp;2.4 Adjusting the Time Format
</b></font></td></tr></table>

```{r message=FALSE, warning=FALSE}
df4 <- df3 %>%
  mutate(
    Year = year(mdy(Date)), 
    Month = month(mdy(Date)), 
    Weekday = wday(mdy(Date)), 
    Hour = hour(Time)
  )
glimpse(df4)
```

<table style="width: 900px"><tr><td bgcolor="wheat"><font color="brown" size="5"><b>
&nbsp;&nbsp;2.5 Handling Missing Values and Errors
</b></font></td></tr></table>

```{r}
df5 <- df4 %>%
  mutate(
    Borough = case_when(
      Borough %in% c("STATEN ISLAND") ~ "STATEN ISL",
      TRUE ~ as.character(Borough)
    ),
    Perp_Age = case_when(
      Perp_Age %in% c("nan", "(null)", NA, "940", "224", "1020") ~ "UNKNOWN",
      TRUE ~ as.character(Perp_Age)
    ),
    Perp_Sex = case_when(
      Perp_Sex %in% c("nan", "(null)", NA, "U") ~ "UNKNOWN",
      Perp_Sex == "F" ~ "FEMALE",
      Perp_Sex == "M" ~ "MALE",
      TRUE ~ as.character(Perp_Sex)
    ),
    Perp_Race = case_when(
      Perp_Race %in% c("nan", "(null)", NA) ~ "UNKNOWN",
      Perp_Race == "ASIAN / PACIFIC ISLANDER" ~ "ASIAN",
      Perp_Race == "AMERICAN INDIAN/ALASKAN NATIVE" ~ "UNKNOWN",
      Perp_Race == "BLACK HISPANIC" ~ "BHISPANIC",
      Perp_Race == "WHITE HISPANIC" ~ "WHISPANIC",
      TRUE ~ as.character(Perp_Race)
    ),
    Vic_Age = case_when(
      Vic_Age == "1022" ~ "UNKNOWN",
      TRUE ~ as.character(Vic_Age)
    ),
    Vic_Sex = case_when(
      Vic_Sex %in% c("nan", "(null)", "U") ~ "UNKNOWN",
      Vic_Sex == "F" ~ "FEMALE",
      Vic_Sex == "M" ~ "MALE",
      TRUE ~ as.character(Vic_Sex)
    ),
    Vic_Race = case_when(
      Vic_Race %in% c("nan", "(null)") ~ "UNKNOWN",
      Vic_Race == "ASIAN / PACIFIC ISLANDER" ~ "ASIAN",
      Vic_Race == "AMERICAN INDIAN/ALASKAN NATIVE" ~ "UNKNOWN",
      Vic_Race == "BLACK HISPANIC" ~ "BHISPANIC",
      Vic_Race == "WHITE HISPANIC" ~ "WHISPANIC",
      TRUE ~ as.character(Vic_Race)
    )
  )
```

```{r}
df5 <- df5[!is.na(df4$Latitude) & !is.na(df4$Longitude),]

df5$Borough  <- factor(df5$Borough)
df5$Precinct <- factor(df5$Precinct)
df5$Perp_Age <- factor(df5$Perp_Age)
df5$Perp_Sex <- factor(df5$Perp_Sex)
df5$Perp_Race <- factor(df5$Perp_Race)
df5$Vic_Age <- factor(df5$Vic_Age)
df5$Vic_Sex <- factor(df5$Vic_Sex)
df5$Vic_Race <- factor(df5$Vic_Race)
glimpse(df5)
```

<table style="width: 900px"><tr><td bgcolor="wheat"><font color="brown" size="5"><b>
&nbsp;&nbsp;2.6 Removing Duplicates
</b></font></td></tr></table>

```{r}
any(duplicated(df5))
```

#### **Summary:**
#### 1. After cleaning the data, we now have 27,302 relatively complete case records ready for analysis.
#### 2. About 40% of the perpetrator information is missing, likely because of limitations in the cases.
#### 3. The records related to time, location, and victims are quite complete, indicating the overall data quality is good.

----------------------------------------------------------------------------------------------------------------------------------------------------------------------

<table style="width: 900px"><tr><td bgcolor="darkred"><font color="white" size="6"><b>
&nbsp;&nbsp;3. Timeline Trend Analysis
</b></font></td></tr></table>

<table style="width: 900px"><tr><td bgcolor="wheat"><font color="brown" size="5"><b>
&nbsp;&nbsp;3.1 Exploring Time Distribution
</b></font></td></tr></table>

#### Shootings per Year:

```{r}
# Calculate the statistics for shootings per year
shootings_year <- df5 %>%
  group_by(Year) %>%
  summarise(Counts = n())

# Calculate the average shootings per year
avg_year <- shootings_year %>%
  summarise(Counts = mean(Counts), Year = "")

# Calculate the top and bottom years
high_years <- shootings_year %>%
  top_n(6, wt = Counts) %>%
  arrange(desc(Counts)) %>%
  mutate(Year = as.character(Year))

low_years <- shootings_year %>%
  top_n(-6, wt = Counts) %>%
  arrange(desc(Counts)) %>%
  mutate(Year = as.character(Year))

# Combine the data frames
combined_df <- bind_rows(data.frame(Group = "Highest", high_years),
                          data.frame(Group = "Average", avg_year), 
                          data.frame(Group = "Lowest", low_years)
)
# Create a styled table using kableExtra
year_table <- combined_df %>%
  knitr::kable(format = "html", escape = FALSE, digits = 0) %>%
  kable_styling(bootstrap_options = "striped", full_width = FALSE) %>%
  column_spec(1:3, width = "8em") %>%
  row_spec(0:0, align = "c", bold = TRUE, color = "white", background = "brown") %>%
  row_spec(1:6, align = "c", bold = TRUE, color = "red") %>%
  row_spec(7:7, align = "c", bold = TRUE, color = "white", background = "grey") %>%
  row_spec(8:13, align = "c", bold = TRUE, color = "green")
year_table
```

#### Shootings per Month:

```{r}
df6 <- df5 %>%
  mutate(Month = paste(Year, Month, sep = "-"))

# Calculate the statistics for shootings per year-month combination
shootings_month <- df6 %>%
  group_by(Month) %>%
  summarise(Counts = n())

# Calculate the average shootings per year-month combination
avg_month <- shootings_month %>%
  summarise(Counts = mean(Counts), Month = "")

# Calculate the top and bottom months
high_months <- shootings_month %>%
  top_n(6, wt = Counts) %>%
  arrange(desc(Counts))

low_months <- shootings_month %>%
  top_n(-6, wt = Counts) %>%
  arrange(desc(Counts))

# Combine the data frames
combined_df_month <- bind_rows(data.frame(Group = "Highest", high_months),
                                data.frame(Group = "Average", avg_month), 
                                data.frame(Group = "Lowest", low_months)
)

# Create a styled table using kableExtra
month_table <- combined_df_month %>%
  knitr::kable(format = "html", escape = FALSE, digits = 0) %>%
  kable_styling(bootstrap_options = "striped", full_width = FALSE) %>%
  column_spec(1:3, width = "8em") %>%
  row_spec(0:0, align = "c", bold = TRUE, color = "white", background = "brown") %>%
  row_spec(1:6, align = "c", bold = TRUE, color = "red") %>%
  row_spec(7:7, align = "c", bold = TRUE, color = "white", background = "grey") %>%
  row_spec(8:13, align = "c", bold = TRUE, color = "green")
month_table
```

#### Shootings per Day:

```{r}
# Calculate the statistics for shootings per day
shootings_day <- df5 %>%
  group_by(Date) %>%
  summarise(Counts = n())
# Calculate the average shootings per day
avg_day <- shootings_day %>%
  summarise(Counts = mean(Counts), Date = "")
# Calculate the top and bottom days
high_days <- shootings_day %>%
  top_n(6, wt = Counts) %>%
  arrange(desc(Counts))
low_days <- shootings_day %>%
  arrange(Counts) %>%
  filter(Counts == min(Counts)) %>%
  sample_n(6)
# Combine the data frames
combined_df_day <- bind_rows(data.frame(Group = "Highest", high_days),
                              data.frame(Group = "Average", avg_day), 
                              data.frame(Group = "Lowest", low_days)
)
# Create a styled table using kableExtra
day_table <- combined_df_day %>%
  knitr::kable(format = "html", escape = FALSE, digits = 0) %>%
  kable_styling(bootstrap_options = "striped", full_width = FALSE) %>%
  column_spec(1:3, width = "8em") %>%
  row_spec(0:0, align = "c", bold = TRUE, color = "white", background = "brown") %>%
  row_spec(1:6, align = "c", bold = TRUE, color = "red") %>%
  row_spec(7:7, align = "c", bold = TRUE, color = "white", background = "grey") %>%
  row_spec(8:13, align = "c", bold = TRUE, color = "green")
day_table
```

<table style="width: 900px"><tr><td bgcolor="wheat"><font color="brown" size="5"><b>
&nbsp;&nbsp;3.2 Comparison of Shootings Across Different Timeline Intervals
</b></font></td></tr></table>

```{r fig.height=9, fig.width=16}
# Plot1 - Year
Year_counts <- df5 %>%
  group_by(Year) %>%
  summarise(Counts = n())
# Relabel not use
Year_x <- c('2006', '07', '08', '09', '10', '11', '12', '13', '14', '15', '16', '17', '18', '19', '20', '21', '2022')
T1 <- ggplot(Year_counts, aes(Year, Counts)) +
  geom_line(linewidth = 4, color = "black") +
  geom_point(size = 6, shape = 15, color = "red") +
  labs(title = " Shootings Across Yearly ",
       x = "Yearly",
       y = " Total Shootings ") +
  scale_x_continuous(breaks = seq(2006, 2022, by = 1)) +
  scale_y_continuous(breaks = seq(0, 2500, by = 400), limits = c(0, 2500)) +
  theme_wsj() +
  theme(
    title = element_text(size = 16),
    axis.text = element_text(size = 12),
    axis.title = element_text(size = 14, face = "bold")
    )
# Plot2 - Month
Month_counts <- df5 %>%
  group_by(Month) %>%
  summarise(Counts = n())
# Relabel
Month_x <- c('Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec')
T2 <- ggplot(Month_counts, aes(Month, Counts)) +
  geom_line(linewidth = 4, color = "black") +
  geom_point(size = 6, shape = 15, color = "red") +
  labs(title = " Shootings Across Monthly ",
       x = " Monthly ",
       y = " Total Shootings ") +
  scale_x_continuous(breaks = seq(1, 12, by = 1), labels = Month_x) +
  scale_y_continuous(breaks = seq(0, 3500, by = 500), limits = c(0, 3500)) +
  theme_wsj() +
  theme(
    title = element_text(size = 16),
    axis.text = element_text(size = 12),
    axis.title = element_text(size = 14, face = "bold")
    )
# Plot3 - Weekday
Weekday_counts <- df5 %>%
  group_by(Weekday) %>%
  summarise(Counts = n())
# Relabel
Weekday_x <- c('Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat')
T3 <- ggplot(Weekday_counts, aes(Weekday, Counts)) +
  geom_line(linewidth = 4, color = "black") +
  geom_point(size = 6, shape = 15, color = "red") +
  labs(title = " Shootings Across Daily ",
       x = " Daily ",
       y = " Total Shootings ") +
  scale_x_continuous(breaks = seq(1, 7, by = 1), labels = Weekday_x) +
  scale_y_continuous(breaks = seq(0, 6000, by = 1000), limits = c(0, 6000)) +
  theme_wsj() +
  theme(
    title = element_text(size = 16),
    axis.text = element_text(size = 12),
    axis.title = element_text(size = 14, face = "bold")
    )
# Plot4 - Hour
Hour_counts <- df5 %>%
  group_by(Hour) %>%
  summarise(Counts = n())
T4 <- ggplot(Hour_counts, aes(Hour, Counts)) +
  geom_line(linewidth = 4, color = "black") +
  geom_point(size = 6, shape = 15, color = "red") +
  labs(title = " Shootings Across Hourly ",
       x = " Hourly ",
       y = " Total Shootings ") +
  scale_x_continuous(breaks = seq(0, 23, by = 1)) +
  scale_y_continuous(breaks = seq(0, 2400, by = 400), limits = c(0, 2400)) +
  theme_wsj() +
  theme(
    title = element_text(size = 16),
    axis.text = element_text(size = 12),
    axis.title = element_text(size = 14, face = "bold")
    )
# Title
T5 <- ggplot() +
  ggtitle("Comparison of Shootings Across Different Time Intervals") +
  labs(subtitle = 
  " - Peaks and valleys are significant across various time intervals
 - Summer, weekends, and midnights are obviously higher than others") +
  theme_wsj() +
  theme(plot.title = element_text(size = 32, face="bold", vjust = -1, color = "brown"),
        plot.subtitle = element_text(size = 28, vjust = -2, color = "red"))
# Combine
options(repr.plot.width = 16, repr.plot.height = 9)
r1 <- plot_grid(T1, T2, T3, T4, ncol=2, nrow = 2)
plot_grid(T5, r1, ncol = 1, rel_heights = c(0.25, 1))
```

<table style="width: 900px"><tr><td bgcolor="wheat"><font color="brown" size="5"><b>
&nbsp;&nbsp;3.3 Comparison Across Different Time Intervals by Boroughs
</b></font></td></tr></table>

```{r fig.height=9, fig.width=16}
# Plot1 - Year
Year_counts <- df5 %>%
  group_by(Year, Borough) %>%
  summarise(Counts = n(), .groups = "drop")
# Relabel not use
Year_x <- c('2006', '07', '08', '09', '10', '11', '12', '13', '14', '15', '16', '17', '18', '19', '20', '21', '2022')
B1 <- ggplot(Year_counts, aes(Year, Counts), color = Borough) +
  geom_line(linewidth = 1.5, aes(color = Borough)) +
  geom_point(size = 3, shape = 15, aes(color = Borough)) +
  labs(title = " Shootings Across Yearly ",
       x = " Yearly ",
       y = " Total Shootings ") +
  scale_x_continuous(breaks = seq(2006, 2022, by = 1)) +
  scale_y_continuous(breaks = seq(0, 1000, by = 200), limits = c(0, 900)) +
  theme_wsj() +
  theme(
    title = element_text(size = 16),
    axis.text = element_text(size = 12),
    axis.title = element_text(size = 14, face = "bold"),
    legend.text = element_text(size = 12),
    legend.title = element_text(size = 0),
    plot.subtitle = element_text(color = "red")
  ) +
  scale_fill_discrete(breaks = c("BROOKLYN", "BRONX", "QUEENS", "MANHATTAN", "STATEN ISL"))
# Plot2 - Month
Month_counts <- df5 %>%
  group_by(Month, Borough) %>%
  summarise(Counts = n(), .groups = "drop")
# Relabel
Month_x <- c('Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec')
B2 <- ggplot(Month_counts, aes(Month, Counts), color = Borough) +
  geom_line(linewidth = 1.5, aes(color = Borough)) +
  geom_point(size = 3, shape = 15, aes(color = Borough)) +
  labs(title = " Shootings Across Monthly ",
       x = " Monthly ",
       y = " Total Shootings ") +
  scale_x_continuous(breaks = seq(1, 12, by = 1), labels = Month_x) +
  scale_y_continuous(breaks = seq(0, 1400, by = 200), limits = c(0, 1500)) +
  theme_wsj() +
  theme(
    title = element_text(size = 16),
    axis.text = element_text(size = 12),
    axis.title = element_text(size = 14, face = "bold"),
    legend.text = element_text(size = 12),
    legend.title = element_text(size = 0),
    plot.subtitle = element_text(color = "red")
  ) +
  scale_fill_discrete(breaks = c("BROOKLYN", "BRONX", "QUEENS", "MANHATTAN", "STATEN ISL"))
# Plot3 - Weekday
Weekday_counts <- df5 %>%
  group_by(Weekday, Borough) %>%
  summarise(Counts = n(), .groups = "drop")
# Relabel
Weekday_x <- c('Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat')
B3 <- ggplot(Weekday_counts, aes(Weekday, Counts), color = Borough) +
  geom_line(linewidth = 1.5, aes(color = Borough)) +
  geom_point(size = 3, shape = 15, aes(color = Borough)) +
  labs(title = " Shootings Across Daily",
       x = " Daily ",
       y = " Total Shootings ") +
  scale_x_continuous(breaks = seq(1, 7, by = 1), labels = Weekday_x) +
  scale_y_continuous(breaks = seq(0, 2200, by = 300), limits = c(0, 2200)) +
  theme_wsj() +
  theme(
    title = element_text(size = 16),
    axis.text = element_text(size = 12),
    axis.title = element_text(size = 14, face = "bold"),
    legend.text = element_text(size = 12),
    legend.title = element_text(size = 0),
    plot.subtitle = element_text(color = "red")
  ) +
  scale_fill_discrete(breaks = c("BROOKLYN", "BRONX", "QUEENS", "MANHATTAN", "STATEN ISL"))
# Plot4 - Hour
Hour_counts <- df5 %>%
  group_by(Hour, Borough) %>%
  summarise(Counts = n(), .groups = "drop")
B4 <- ggplot(Hour_counts, aes(Hour, Counts), color = Borough) +
  geom_line(linewidth = 1.5, aes(color = Borough)) +
  geom_point(size = 3, shape = 15, aes(color = Borough)) +
  labs(title = " Shootings Across Hourly ",
       x = " Hourly ",
       y = " Total Shootings ") +
  scale_x_continuous(breaks = seq(0, 23, by = 1)) +
  scale_y_continuous(breaks = seq(0, 900, by = 300), limits = c(0, 1000)) +
  theme_wsj() +
  theme(
    title = element_text(size = 16),
    axis.text = element_text(size = 12),
    axis.title = element_text(size = 14, face = "bold"),
    legend.text = element_text(size = 12),
    legend.title = element_text(size = 0),
    plot.subtitle = element_text(color = "red")
  ) +
  scale_fill_discrete(breaks = c("BROOKLYN", "BRONX", "QUEENS", "MANHATTAN", "STATEN ISL"))
# Title
B5 <- ggplot() +
  ggtitle("Comparison Across Different Time Intervals by Boroughs") +
  labs(subtitle = 
  " - Boroughs Display Similar Trends Across Different Time Intervals
 - Brooklyn and Bronx Show Larger Peaks and Valleys Disparities") +
  theme_wsj() +
  theme(plot.title = element_text(size = 32, face="bold", vjust = -1, color = "brown"),
        plot.subtitle = element_text(size = 28, vjust = -2, color = "red"))
# Combine
options(repr.plot.width = 16, repr.plot.height = 9)
r1 <- plot_grid(B1, B2, B3, B4, ncol=2, nrow = 2)
plot_grid(B5, r1, ncol = 1, rel_heights = c(0.25, 1))
```

#### **Summary:**
#### 1. The overall trend shows a decline from 2006 to 2019, followed by a significant boost in the past three years.
#### 2. Cases are notably higher during summer, weekends, and midnight hours compared to other time periods.
#### 3. Boroughs exhibit consistent trends, with Brooklyn and Bronx displaying larger differences in peaks and valleys.

----------------------------------------------------------------------------------------------------------------------------------------------------------------------

<table style="width: 900px"><tr><td bgcolor="darkred"><font color="white" size="6"><b>
&nbsp;&nbsp;4. Geographical Distribution Analysis
</b></font></td></tr></table>

<table style="width: 900px"><tr><td bgcolor="wheat"><font color="brown" size="5"><b>
&nbsp;&nbsp;4.1 Comparison of Shootings Across Different Boroughs (2006'~2022')
</b></font></td></tr></table>

```{r fig.height=9, fig.width=16, warning=TRUE}
B1 <- ggplot(df5, aes(Borough)) +
  geom_bar(aes(fill = Borough)) +
  ylab(" Total Shootings ") +
  xlab(" Boroughs ") +
  scale_y_continuous(breaks = seq(0, 12000, by = 2000), limits = c(0, 12000)) + 
  theme_wsj()+
  theme(
    axis.title = element_text(size = 14, face="bold"),
    axis.text.x = element_text(angle = 0, size = 12),
    axis.text.y = element_text(size = 12),
    legend.title = element_text(size = 0),
    legend.text = element_text(size = 20 ),
  ) +
  scale_x_discrete(limits = c("MANHATTAN", "BRONX", "BROOKLYN", "QUEENS", "STATEN ISL")) +
  scale_fill_discrete(breaks = c("MANHATTAN", "BRONX", "BROOKLYN", "QUEENS", "STATEN ISL"))
# Title
B2 <- ggplot() +
  ggtitle("Comparison of Shootings Across Boroughs (2006~2022)") +
  labs(subtitle = 
  " - Brooklyn: Nearly 11,000 shootings, over 40% of total
 - Bronx: Close to 8,000 incidents, about 30% of total") +
  theme_wsj() +
  theme(plot.title = element_text(size = 32, face="bold", vjust = -1, color = "brown"),
        plot.subtitle = element_text(size = 28, vjust = -2, color = "red"))
# Combine
options(repr.plot.width = 16, repr.plot.height = 9)
plot_grid(B2, B1, ncol = 1, rel_heights = c(0.25, 1))
```

<table style="width: 900px"><tr><td bgcolor="wheat"><font color="brown" size="5"><b>
&nbsp;&nbsp;4.2 Comparison of Shootings Across Different Precints (2006'~2022')
</b></font></td></tr></table>

```{r fig.height=9, fig.width=16}
# Plot1
P1 <- ggplot(df5, aes(Precinct, fill = Borough)) +
  geom_bar() +
  ylab(" Total Shootings ") +
  xlab(" Precincts ") +
  scale_y_continuous(breaks = seq(0, 1500, by = 300), limits = c(0, 1600)) +
  theme_wsj()+
  theme(
    axis.title = element_text(size = 14, face="bold"),
    axis.text.x = element_text(angle = 45, size = 12),
    axis.text.y = element_text(size = 12),
    legend.title = element_text(size = 0),
    legend.text = element_text(size = 20 ),
  ) +
  scale_fill_discrete(breaks = c("MANHATTAN", "BRONX", "BROOKLYN", "QUEENS", "STATEN ISL"))
# Title
P2 <- ggplot() +
  ggtitle("Comparison of Shootings Across Precincts (2006~2022)") +
  labs(subtitle = 
  " - Brooklyn precincts (73' and 75') lead in shooting numbers
 - Bronx precincts consistently show high counts") +
  theme_wsj() +
  theme(plot.title = element_text(size = 32, face="bold", vjust = -1, color = "brown"),
        plot.subtitle = element_text(size = 28, vjust = -2, color = "red"))
# Combine
options(repr.plot.width = 16, repr.plot.height = 9)
plot_grid(P2, P1, ncol = 1, rel_heights = c(0.25, 1))
```

<table style="width: 900px"><tr><td bgcolor="wheat"><font color="brown" size="5"><b>
&nbsp;&nbsp;4.3 Comparing the case maps of 2006, 2019, and 2022
</b></font></td></tr></table>

#### Shooting Map 2006:

```{r}
# location1
interval <- df5[df5$Year == 2006 & df5$Month >= 1 & df5$Month <= 12, ]
map <- leaflet(width = "350px", height = "350px") %>%
  addTiles() %>%
  setView(lat = 40.73, lng = -73.95, zoom = 10)
location1 <- map %>%
  addCircleMarkers(data = interval, 
                   lng = ~Longitude, lat = ~Latitude, 
                   radius = 2,
                   fillColor = "darkblue",
                   fillOpacity = 1,
                   stroke = FALSE)
location1
```

#### Shooting Map 2018:

```{r}
# location2
interval <- df5[df5$Year == 2018 & df5$Month >= 1 & df5$Month <= 12, ]
map <- leaflet(width = "350px", height = "350px") %>%
  addTiles() %>%
  setView(lat = 40.73, lng = -73.95, zoom = 10)
location2 <- map %>%
  addCircleMarkers(data = interval, lat = ~Latitude, lng = ~Longitude,  
                   radius = 2,
                   fillColor = "darkblue",
                   fillOpacity = 1,
                   stroke = FALSE)
location2
```

#### Shooting Map 2022:

```{r}
# location3
interval <- df5[df5$Year == 2022 & df5$Month >= 1 & df5$Month <= 12, ]
map <- leaflet(width = "350px", height = "350px") %>%
  addTiles() %>%
  setView(lat = 40.73, lng = -73.95, zoom = 10)
location3 <- map %>%
  addCircleMarkers(data = interval, lat = ~Latitude, lng = ~Longitude,  
                   radius = 2,
                   fillColor = "darkblue",
                   fillOpacity = 1,
                   stroke = FALSE)
location3
```

#### **Summary:**
#### 1. 70% of shootings took place in Brooklyn and the Bronx, with the Bronx surpassing Brooklyn recently.
#### 2. Shootings are highly concentrated in certain areas of Brooklyn, while they cover the entire region in the Bronx.
#### 3. Other areas show relatively scattered incidents, but there has been an increasing trend in recent years.

----------------------------------------------------------------------------------------------------------------------------------------------------------------------



<table style="width: 900px"><tr><td bgcolor="darkred"><font color="white" size="6"><b>
&nbsp;&nbsp;5. Suspects & Victims Analysis
</b></font></td></tr></table>

<table style="width: 900px"><tr><td bgcolor="wheat"><font color="brown" size="5"><b>
&nbsp;&nbsp;5.1 Comparison of Perpetrators and Victims Across Age Groups
</b></font></td></tr></table>

```{r fig.height=9, fig.width=16}
# Plot1
df5_Perp_Age <- df5[df5$Perp_Age != "UNKNOWN", ]

A1 <- ggplot(df5_Perp_Age, aes(Perp_Age, fill = Perp_Age)) +
  geom_bar() +
  labs(title = "Perpetrators (Excl.Unknown)",
       x = "Perpetrators Age Groups",
       y = "Total Shootings") +
  theme_wsj() +
  theme(
    title = element_text(size = 15),
    axis.text = element_text(size = 12),
    axis.title = element_text(size = 14, face = "bold"),
    legend.position = "none"
    )
# Plot2
df5_Vic_Age <- df5[df5$Vic_Age != "UNKNOWN", ]

A2 <- ggplot(df5_Vic_Age, aes(Vic_Age, fill = Vic_Age)) +
  geom_bar() +
  labs(title = "Victims",
       x = "Victims Age Groups",
       y = "Total Shootings") +
  theme_wsj() +
  theme(
    title = element_text(size = 16),
    axis.text = element_text(size = 12),
    axis.title = element_text(size = 14, face = "bold"),
    legend.position = "none"
    )
# Plot3
Age_df <- df5[df5$Perp_Age != "UNKNOWN" & df5$Vic_Age != "UNKNOWN", ]
Age_tab <- table(Age_df$Perp_Age, Age_df$Vic_Age)
Age_order <- c("<18", "18-24", "25-44", "45-64", "65+")
Age_tab <- Age_tab[Age_order, Age_order]
Age_tab <- as.data.frame(as.table(Age_tab))
names(Age_tab) <- c("Perp_Age", "Vic_Age", "Count")

A3 <- ggplot(Age_tab, aes(Perp_Age, Vic_Age, fill = Count)) +
  geom_tile() +
  geom_text(aes(label = Count), color = "black", size = 5) +
  scale_fill_gradient(low = "beige", high = "red") +
  labs(title = "Perpetrators vs. Victims",
       x = "Perpetrators Age Groups",
       y = "Victims Age Groups") +
  theme_wsj() +
  theme(
    title = element_text(size = 16),
    axis.text = element_text(size = 12, face = "bold"),
    axis.title = element_text(size = 14, face = "bold"),
    legend.position = "none",
    panel.grid.major.y = element_blank()
    )
# Title
A4 <- ggplot() +
  ggtitle("Comparison of Perpetrators and Victims Across Age Groups") +
  labs(subtitle = 
  " - '18-24' and '25-44' groups contribute to 70% of shootings
 - Age group <18 is involved in more shootings than the >45 groups") +
  theme_wsj() +
  theme(plot.title = element_text(size = 32, face="bold", vjust = -1, color = "brown"),
        plot.subtitle = element_text(size = 28, vjust = -2, color = "red"))
# Combine
options(repr.plot.width = 16, repr.plot.height = 9)
r1 <- plot_grid(A1, A3, A2, nrow = 1, rel_widths = c(1, 1.2, 1))
plot_grid(A4, r1, ncol = 1, rel_heights = c(0.25, 1))
```

<table style="width: 900px"><tr><td bgcolor="wheat"><font color="brown" size="5"><b>
&nbsp;&nbsp;5.2 Comparison of Perpetrators and Victims Across Race Groups
</b></font></td></tr></table>

```{r fig.height=9, fig.width=16}
# Plot1
df5_Perp_Race <- df5[df5$Perp_Race != "UNKNOWN", ]

R1 <- ggplot(df5_Perp_Race, aes(Perp_Race, fill = Perp_Race)) +
  geom_bar() +
  labs(title = "Perpetrators (Excl.Unknown)",
       x = "Perpetrators Race Groups",
       y = "Total Shootings") +
  theme_wsj() +
  theme(
    title = element_text(size = 15),
    axis.text = element_text(size = 11),
    axis.title = element_text(size = 14, face = "bold"),
    legend.position = "none"
    ) +
  scale_x_discrete(limits = c('ASIAN', 'BHISPANIC', 'BLACK', 'WHISPANIC', 'WHITE'))
# Plot2
df5_Vic_Race <- df5[df5$Vic_Race != "UNKNOWN", ]

R2 <- ggplot(df5_Vic_Race, aes(Vic_Race, fill = Vic_Race)) +
  geom_bar() +
  labs(title = "Victims",
       x = "Victims Race Groups",
       y = "Total Shootings") +
  theme_wsj() +
  theme(
    title = element_text(size = 16),
    axis.text = element_text(size = 11),
    axis.title = element_text(size = 14, face = "bold"),
    legend.position = "none"
    ) +
  scale_x_discrete(limits = c('ASIAN', 'BHISPANIC', 'BLACK', 'WHISPANIC', 'WHITE'))
# Plot3
Race_df <- df5[df5$Perp_Race != "UNKNOWN" & df5$Vic_Race != "UNKNOWN", ]
Race_tab <- table(Race_df$Perp_Race, Race_df$Vic_Race)
Race_order <- c('ASIAN', 'BHISPANIC', 'BLACK', 'WHISPANIC', 'WHITE')
Race_tab <- Race_tab[Race_order, Race_order]
Race_tab <- as.data.frame(as.table(Race_tab))
names(Race_tab) <- c("Perp_Race", "Vic_Race", "Count")

R3 <- ggplot(Race_tab, aes(Perp_Race, Vic_Race, fill = Count)) +
  geom_tile() +
  geom_text(aes(label = Count), color = "black", size = 6) +
  scale_fill_gradient(low = "beige", high = "red") +
  labs(title = "Perpetrators vs. Victims",
       x = "Perpetrators Race Groups",
       y = "Victims Race Groups") +
  theme_wsj() +
  theme(
    title = element_text(size = 16),
    axis.text = element_text(size = 11, face = "bold"),
    axis.title = element_text(size = 14, face = "bold"),
    legend.position = "none",
    panel.grid.major.y = element_blank()
    )
# Title
R4 <- ggplot() +
  ggtitle("Comparison of Perpetrators and Victims Across Race Groups") +
  labs(subtitle = 
  " - Black takes up about 70% of shootings in both Perps and Vics
 - White and Black Hispanic together exceed 20% in both groups") +
  theme_wsj() +
  theme(plot.title = element_text(size = 32, face="bold", vjust = -1, color = "brown"),
        plot.subtitle = element_text(size = 28, vjust = -2, color = "red"))
# Combine
options(repr.plot.width = 16, repr.plot.height = 9)
r1 <- plot_grid(R1, R3, R2, nrow = 1, rel_widths = c(1, 1.2, 1))
plot_grid(R4, r1, ncol = 1, rel_heights = c(0.25, 1))
```

<table style="width: 900px"><tr><td bgcolor="wheat"><font color="brown" size="5"><b>
&nbsp;&nbsp;5.3 Comparison of Perpetrators and Victims Across Gender Groups
</b></font></td></tr></table>

```{r fig.height=9, fig.width=16}
# Plot1
df5_Perp_Sex <- df5[df5$Perp_Sex != "UNKNOWN", ]

S1 <- ggplot(df5_Perp_Sex, aes(Perp_Sex, fill = Perp_Sex)) +
  geom_bar() +
  labs(title = "Perpetrators (Excl.Unknown)",
       x = "Perpetrators Gender Groups",
       y = "Total Shootings") +
  theme_wsj() +
  theme(
    title = element_text(size = 15),
    axis.text = element_text(size = 12),
    axis.title = element_text(size = 14, face = "bold"),
    legend.position = "none"
    ) +
  scale_x_discrete(limits = c("MALE", "FEMALE"))
# Plot2
df5_Vic_Sex <- df5[df5$Vic_Sex != "UNKNOWN", ]

S2 <- ggplot(df5_Vic_Sex, aes(Vic_Sex, fill = Vic_Sex)) +
  geom_bar() +
  labs(title = "Victims",
       x = "Victims Gender Groups",
       y = "Total Shootings") +
  theme_wsj() +
  theme(
    title = element_text(size = 16),
    axis.text = element_text(size = 12),
    axis.title = element_text(size = 14, face = "bold"),
    legend.position = "none"
    ) +
  scale_x_discrete(limits = c("MALE", "FEMALE"))
# Plot3
Sex_df <- df5[df5$Perp_Sex != "UNKNOWN" & df5$Vic_Sex != "UNKNOWN", ]
Sex_tab <- table(Sex_df$Perp_Sex, Sex_df$Vic_Sex)
Sex_order <- c('MALE', 'FEMALE')
Sex_tab <- Sex_tab[Sex_order, Sex_order]
Sex_tab <- as.data.frame(as.table(Sex_tab))
names(Sex_tab) <- c("Perp_Sex", "Vic_Sex", "Count")

S3 <- ggplot(Sex_tab, aes(Perp_Sex, Vic_Sex, fill = Count)) +
  geom_tile() +
  geom_text(aes(label = Count), color = "black", size = 6) +
  scale_fill_gradient(low = "beige", high = "red") +
  labs(title = "Perpetrators vs. Victims",
       x = "Perpetrators Gender Groups",
       y = "Victims Gender Groups") +
  theme_wsj() +
  theme(
    title = element_text(size = 16),
    axis.text = element_text(size = 12, face = "bold"),
    axis.title = element_text(size = 14, face = "bold"),
    legend.position = "none",
    panel.grid.major.y = element_blank()
    )
# Title
S4 <- ggplot() +
  ggtitle("Comparison of Perpetrators and Victims Across Genders") +
  labs(subtitle = 
  " - Over 97% of Perpetrators are male
 - More than 89% of Victims are male") +
  theme_wsj() +
  theme(plot.title = element_text(size = 32, face="bold", vjust = -1, color = "brown"),
        plot.subtitle = element_text(size = 28, vjust = -2, color = "red"))
# Combine
options(repr.plot.width = 16, repr.plot.height = 9)
r1 <- plot_grid(S1, S3, S2, nrow = 1, rel_widths = c(1, 1, 1))
plot_grid(S4, r1, ncol = 1, rel_heights = c(0.25, 1))
```

#### **Summary:**
#### 1. The individuals related to the cases share noticeable similarities in terms of age, race, and gender.
#### 2. Victims of the cases are not randomly distributed but rather part of organized patterns.
#### 3. There is a significant trend toward involving younger individuals, even including a great number of teenagers.

----------------------------------------------------------------------------------------------------------------------------------------------------------------------

<table style="width: 900px"><tr><td bgcolor="darkred"><font color="white" size="6"><b>
&nbsp;&nbsp;6. Time Series Analysis and Forecasting
</b></font></td></tr></table>

<table style="width: 900px"><tr><td bgcolor="wheat"><font color="brown" size="5"><b>
&nbsp;&nbsp;6.1 Time Series Monitor by Year & Month
</b></font></td></tr></table>

```{r fig.height=9, fig.width=16}
# Plot1
df6_YearMonth <- df5 %>%
  mutate(Date = mdy(Date),
         YearMonth = format(Date, "%Y-%m")) %>%
  group_by(YearMonth) %>%
  summarise(Counts = n())

L1 <- ggplot(df6_YearMonth, aes(YearMonth, Counts, group = 1)) +
  geom_line(linewidth = 2, color = "darkred") +
  geom_point(size = 3, shape = 15, color = "darkred") +
  labs(x= " Year & Month " ,
       y = " Total Shootings ") +
  scale_x_discrete(breaks = df6_YearMonth$YearMonth[seq(1, nrow(df6_YearMonth), 6)]) +
  scale_y_continuous(breaks = seq(0, 350, by = 50), limits = c(0, 350)) +
  theme_wsj() +
  theme(
    axis.title = element_text(size = 14, face="bold"),
    axis.text.x = element_text(angle = 45, size = 12, vjust = 0.5),
    axis.text.y = element_text(size = 12)
  )
# Title
L2 <- ggplot() +
  ggtitle("Time Series Monitor by Year & Month (2006~2022)") +
  labs(subtitle = 
  " - Overall trend is lower in the middle and higher on the sides
 - There is a noticeable seasonal fluctuation within each year") +
  theme_wsj() +
  theme(plot.title = element_text(size = 32, face="bold", vjust = -1, color = "brown"),
        plot.subtitle = element_text(size = 28, vjust = -2, color = "red"))
# Combine
options(repr.plot.width = 16, repr.plot.height = 9)
plot_grid(L2, L1, ncol = 1, rel_heights = c(0.25, 1))
```

<table style="width: 900px"><tr><td bgcolor="wheat"><font color="brown" size="5"><b>
&nbsp;&nbsp;6.2 Time Series Decomposition
</b></font></td></tr></table>

```{r fig.height=9, fig.width=16, message=FALSE, warning=FALSE}
ts_data <- ts(df6_YearMonth$Counts, frequency = 12, start = c(2006, 1))
decompose <- decompose(ts_data, type = "additive")

decomposition_table <- data.frame(
  YearMonth = df6_YearMonth,
  Trend = decompose$trend,
  Seasonal = decompose$seasonal,
  Residual = decompose$random)
# Plot1
D1 <- ggplot(decomposition_table, aes(YearMonth.YearMonth, Trend, group = 1)) +
  geom_line(linewidth = 1.5, color = "darkred") +
  geom_point(size = 3, shape = 15, color = "darkred") +
  labs(
      y = " Trend ") +
  scale_x_discrete(breaks = df6_YearMonth$YearMonth[seq(1, nrow(df6_YearMonth), 6)]) +
  scale_y_continuous(breaks = seq(0, 200, by = 50), limits = c(0, 200)) +
  theme_wsj() +
  theme(
        axis.text.y = element_text(size = 12),
        axis.text.x = element_text(size = 11, angle = 45, vjust = 0.5),
        axis.title.y = element_text(size = 20, face = "bold"),
  )
# Plot2
D2 <- ggplot(decomposition_table, aes(YearMonth.YearMonth, Seasonal, group = 1)) +
  geom_line(linewidth = 1.5, color = "darkred") +
  geom_point(size = 3, shape = 15, color = "darkred") +
  labs(
      y = " Seasonal ") +
  scale_x_discrete(breaks = df6_YearMonth$YearMonth[seq(1, nrow(df6_YearMonth), 6)]) +
  scale_y_continuous(breaks = seq(-60, 60, by = 30), limits = c(-65, 65)) +
  theme_wsj() +
  theme(
        axis.text.y = element_text(size = 12),
        axis.text.x = element_text(size = 11, angle = 45, vjust = 0.5),
        axis.title.y = element_text(size = 20, face = "bold"),
  )
# Plot3
D3 <- ggplot(decomposition_table, aes(YearMonth.YearMonth, Residual, group = 1)) +
  geom_line(linewidth = 1.5, color = "darkred") +
  geom_point(size = 3, shape = 15, color = "darkred") +
  labs(
       y = " Residual ") +
  scale_x_discrete(breaks = df6_YearMonth$YearMonth[seq(1, nrow(df6_YearMonth), 6)]) +
  scale_y_continuous(breaks = seq(-100, 100, by = 50), limits = c(-80, +120)) +
  theme_wsj() +
  theme(
        axis.text.y = element_text(size = 12),
        axis.text.x = element_text(size = 11, angle = 45, vjust = 0.5),
        axis.title.y = element_text(size = 20, face = "bold"),
  )
# Title
D4 <- ggplot() +
  ggtitle("Time Series Decomposition") +
  labs(subtitle = 
  " - Monthly counts decompose into Trend, Seasonal, and Residual
 - High residual suggests randomness or external influence") +
  theme_wsj() +
  theme(plot.title = element_text(size = 32, face="bold", vjust = -1, color = "brown"),
        plot.subtitle = element_text(size = 28, vjust = -2, color = "red"))
# Combine
options(repr.plot.width = 16, repr.plot.height = 9)
r1 <- plot_grid(D1, D2, D3, ncol = 1, rel_widths = c(1, 1, 1))
plot_grid(D4, r1, ncol = 1, rel_heights = c(0.25, 1))
```

```{r message=FALSE, warning=FALSE, paged.print=FALSE}
decompose <- decompose(ts_data, type = "additive")
reg<-lm(decompose$trend~time(ts_data))
#summary(reg)
#par(mfrow=c(2,2))
#plot(reg,which=c(1:4))
```

<table style="width: 900px"><tr><td bgcolor="wheat"><font color="brown" size="5"><b>
&nbsp;&nbsp;6.3 Time Series Forecasting
</b></font></td></tr></table>

```{r fig.height=9, fig.width=16, warning=FALSE}
model <- auto.arima(ts_data)
forecast <- forecast(model, h = 36)
forecast_df <- forecast %>%
  as.data.frame() %>%
  rownames_to_column(var = "YearMonth") %>%
  rename(
    L95 = `Lo 95`,
    H95 = `Hi 95`) %>%
  mutate(
    YearMonth = mdy(YearMonth) %>% format("%Y-%m")
  )
combined_df <- bind_rows(df6_YearMonth, forecast_df)
```

```{r fig.height=9, fig.width=16, warning=FALSE}
combined_df2 <- combined_df %>%
  mutate(YearMonth = paste0(YearMonth, "-01"),  # change it back
         YearMonth = as.Date(YearMonth))
# Plot1
Z1 <- ggplot() +
  geom_ribbon(data = combined_df2 %>% filter(!is.na(L95) & !is.na(H95)),
            aes(x = YearMonth, ymin = L95, ymax = H95), alpha = 0.8, fill = "grey") +
  geom_line(data = combined_df2 %>% filter(!is.na(Counts)),
            aes(x = YearMonth, y = Counts, group = 1), linewidth = 2, color = "black") +
  geom_line(data = combined_df2 %>% filter(!is.na(`Point Forecast`)),
            aes(x = YearMonth, y = `Point Forecast`, group = 1), linewidth = 2, color = "darkred") +
  labs(
       y = " Total Shootings ") +
  scale_x_date(breaks = seq(as.Date("2006-07-01"), as.Date("2025-07-01"), by = "1 year"), date_labels = "%Y") +
  scale_y_continuous(breaks = seq(0, 350, by = 50), limits = c(0, 350)) +
  theme_wsj() +
  theme(
      axis.text = element_text(size = 12),
      axis.text.x = element_text(angle = 0, vjust = 0.5),
      axis.title = element_text(size = 14, face = "bold")
  )
# Title
Z2 <- ggplot() +
  ggtitle("Time Series Forecasting for the Next 3 Years Using ARIMA") +
  labs(subtitle = 
  " - The average trend will stay consistent with the level of 2022
 - The range of fluctuations could reach the peak in 2020") +
  theme_wsj() +
  theme(plot.title = element_text(size = 32, face="bold", vjust = -1, color = "brown"),
        plot.subtitle = element_text(size = 28, vjust = -2, color = "red"))
# Combine
options(repr.plot.width = 16, repr.plot.height = 9)
plot_grid(Z2, Z1, ncol = 1, rel_heights = c(0.25, 1))
```

#### **Summary:**
#### 1. Monthly counts show clear time-series features , decomposable into trend, seasonal, and residual elements.
#### 2. Through ARIMA forecasting, the monthly case counts for the next 3 years are likely to remain current level.
#### 3. In cases of extreme anomalies, the number of cases could potentially reach the peak observed in 2020.

----------------------------------------------------------------------------------------------------------------------------------------------------------------------

<table style="width: 900px"><tr><td bgcolor="darkred"><font color="white" size="6"><b>
&nbsp;&nbsp;7. Conclusion
</b></font></td></tr></table>

<table style="width: 900px"><tr><td bgcolor="wheat"><font color="brown" size="5"><b>
&nbsp;&nbsp;7.1 Report Bias
</b></font></td></tr></table>

#### **Bias in Data Source:**
#### Geographical and shooting incidents exhibit clear concentration in specific areas and demographics, suggesting potential bias in NYPD data recording that overly focuses on particular criminal behaviors. Before delving further into analysis, it's crucial to validate data sources to ensure that analysis is not unduly affected by data bias.
#### **Bias in Data Analysis:**
#### During the analysis process, it's easy to attribute shooting incidents to specific demographics, overlooking the underlying data correlations and overly focusing on individuals rather than other factors. In this analysis, we strive to utilize more dimensions and explore intrinsic correlations within cases, rather than solely concentrating on perpetrator profiles.

<table style="width: 900px"><tr><td bgcolor="wheat"><font color="brown" size="5"><b>
&nbsp;&nbsp;7.2 Report Summary
</b></font></td></tr></table>

#### 1. Through Timeline Trend Analysis, we explored the temporal features of case distribution and found significant peaks during summer, weekends, and midnight.
#### 2. Through Geographical Distribution Analysis, we investigated the spatial patterns of case distribution, revealing notable shooting clusters in Brooklyn and the Bronx.
#### 3. Through Suspects & Victims Analysis, we examined the profile of individuals involved in the cases, identifying distinct perpetrator characteristics and a trend towards involving younger individuals.
#### 4. Through Time Series Analysis and Forecasting, we identified evident seasonal patterns and forecasted shooting counts for the next 3 years.

<table style="width: 900px"><tr><td bgcolor="wheat"><font color="brown" size="5"><b>
&nbsp;&nbsp;7.3 Further Action
</b></font></td></tr></table>

#### 1. By combining geographical and temporal distribution data, the NYPD can adjust patrol schedules and even fund allocation to control and reduce the number of shooting incidents.
#### 2. By deeply investigating the correlation between perpetrators' profile data and other indicators, the NYPD can conduct comprehensive inquiries into organized crime, thereby reducing the frequency of shooting incidents and minimizing the involvement of teenagers.
#### 3. Through time series analysis and external environmental variables, during significant events like elections, preventative measures can be taken to mitigate the risk of potential large-scale shooting incidents.

```{r}
sessionInfo()
```


